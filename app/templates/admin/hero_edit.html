{% extends "admin/base.html" %}
{% from 'admin/components/multilang_field.html' import input, textarea %}

{% block title %}Hero —Å–µ–∫—Ü–∏—è - –ê–¥–º–∏–Ω–∫–∞ OilFusion{% endblock %}

{% block content %}
<div class="admin-edit-page">
  <div class="admin-page-header">
    <h1 class="admin-page-title">Hero —Å–µ–∫—Ü–∏—è</h1>
    <p class="admin-page-subtitle">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–≥–æ –±–∞–Ω–Ω–µ—Ä–∞ –∏ –ø—Ä–∏–∑—ã–≤–æ–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é (üá∑üá∫ RU / üá±üáª LV / üá¨üáß EN)</p>
  </div>

  <div class="admin-section">
    <h2 class="admin-section-title">–ö–æ–Ω—Ç–µ–Ω—Ç Hero —Å–µ–∫—Ü–∏–∏</h2>
    <form method="POST" action="{{ url_for('admin.hero_save', token=token) }}" class="admin-form" enctype="multipart/form-data">
      {{ input(
          name='slogan',
          label='–°–ª–æ–≥–∞–Ω (–∑–∞–≥–æ–ª–æ–≤–æ–∫)',
          content_obj=hero_slogan,
          placeholder='Balance in every drop',
          required=true,
          help_text='–û—Å–Ω–æ–≤–Ω–æ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ'
      ) }}
      
      {{ textarea(
          name='subtitle',
          label='–ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫',
          content_obj=hero_subtitle,
          rows=3,
          placeholder='–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–∞—Å–ª–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π AuraCloud¬Æ 3D –∏ –î–ù–ö-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è',
          help_text='–û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–¥ –æ—Å–Ω–æ–≤–Ω—ã–º –∑–∞–≥–æ–ª–æ–≤–∫–æ–º'
      ) }}
      
      <div class="admin-form-row">
        <div style="flex: 1;">
          {{ input(
              name='cta_primary',
              label='–û—Å–Ω–æ–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞',
              content_obj=hero_cta_primary,
              placeholder='–ü–æ–¥–æ–±—Ä–∞—Ç—å –º–∞—Å–ª–æ',
              help_text='–¢–µ–∫—Å—Ç –ø–µ—Ä–≤–æ–π –∫–Ω–æ–ø–∫–∏'
          ) }}
        </div>
        <div style="flex: 1;">
          {{ input(
              name='cta_secondary',
              label='–í—Ç–æ—Ä–∏—á–Ω–∞—è –∫–Ω–æ–ø–∫–∞',
              content_obj=hero_cta_secondary,
              placeholder='–ó–∞–ø–∏—Å–∞—Ç—å—Å—è',
              help_text='–¢–µ–∫—Å—Ç –≤—Ç–æ—Ä–æ–π –∫–Ω–æ–ø–∫–∏'
          ) }}
        </div>
      </div>
      
      {{ input(
          name='scroll_text',
          label='–¢–µ–∫—Å—Ç —Å–∫—Ä–æ–ª–ª –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞',
          content_obj=hero_scroll_text,
          placeholder='–õ–∏—Å—Ç–∞–π—Ç–µ –≤–Ω–∏–∑',
          help_text='–¢–µ–∫—Å—Ç –ø–æ–¥ –∫–Ω–æ–ø–∫–∞–º–∏ –¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è —Å–∫—Ä–æ–ª–ª–∞'
      ) }}
      
      <div class="admin-form-group">
        <label class="admin-form-label">–§–æ–Ω–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ Hero —Å–µ–∫—Ü–∏–∏</label>
        <div class="admin-image-upload-section">
          <div class="admin-form-group">
            <label for="hero_background_image" class="admin-form-label">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</label>
            <input type="file" id="hero_background_image" name="hero_background_image" class="admin-form-input" accept="image/*" onchange="previewImage(this, 'hero_bg_preview')">
            <div class="admin-form-help">PNG, JPG, JPEG, WEBP, GIF –¥–æ 16MB</div>
          </div>
          
          <div class="admin-form-group">
            <label for="hero_background_url" class="admin-form-label">–ò–ª–∏ URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</label>
            <input type="url" id="hero_background_url" name="hero_background_url" class="admin-form-input" 
                   value="{{ hero_background.image_url if hero_background else '' }}"
                   placeholder="/static/img/hero.png" onchange="previewImageFromUrl(this, 'hero_bg_preview')">
          </div>
          
          <div class="admin-form-group">
            <div class="admin-image-info">
              <div id="hero_bg_preview" class="admin-preview-image admin-preview-image--wide">
                {% if hero_background and hero_background.image_url %}
                <img src="{{ hero_background.image_url }}" alt="–ü—Ä–µ–≤—å—é —Ñ–æ–Ω–∞ Hero">
                {% endif %}
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="admin-form-actions">
        <button type="submit" class="admin-btn admin-btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      </div>
    </form>
  </div>
</div>

<script>
// –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
function previewImage(input, previewId) {
    const preview = document.getElementById(previewId);
    if (input.files && input.files[0]) {
        const reader = new FileReader();
        reader.onload = function(e) {
            preview.innerHTML = `<img src="${e.target.result}" alt="–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä">`;
        };
        reader.readAsDataURL(input.files[0]);
    }
}

function previewImageFromUrl(input, previewId) {
    const preview = document.getElementById(previewId);
    const url = input.value.trim();
    if (url) {
        preview.innerHTML = `<img src="${url}" alt="–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä" onerror="this.style.display='none'">`;
    } else {
        preview.innerHTML = '';
    }
}
</script>

<style>
.admin-image-upload-section {
    background: var(--admin-bg-light);
    padding: 20px;
    border-radius: 8px;
    border: 1px solid var(--admin-border);
}

.admin-image-info {
    margin-top: 16px;
}

.admin-preview-image {
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 120px;
    background: var(--admin-bg);
    border: 2px dashed var(--admin-border);
    border-radius: 8px;
    padding: 16px;
}

.admin-preview-image img {
    max-width: 200px;
    max-height: 150px;
    object-fit: contain;
    border-radius: 8px;
    border: 1px solid var(--admin-border);
}
</style>
{% endblock %}


